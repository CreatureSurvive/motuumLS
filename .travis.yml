os: osx
osx_image: xcode8.1
language: objective-c
sudo: false

env:
  global:
    # $THEOS is absolutely needed for theos to even be found
    - THEOS=~/theos

before_install:
  # update homebrew and install dependencies
  - brew update
  - brew install ldid
  - cd /usr/local/Homebrew/Library/Taps/homebrew/homebrew-core  # cd to the formulae repo
  - git checkout 7a4dabf  # checkout the commit before dpkg was updated
  - HOMEBREW_NO_AUTO_UPDATE=1 brew install dpkg  # install the older dpkg
  - git checkout master  # checkout the latest commit again
  - brew pin dpkg 
  # install theos
  - git clone --recursive git://github.com/theos/theos.git ~/theos

script:
  # build!
  - make package